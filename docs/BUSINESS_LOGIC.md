# Бизнес-логика приложения

## 1. Управление доступом и ролями
*   **Идентификация**: Выполняется автоматически через Telegram ID.
*   **Ролевая модель**:
    *   `Admin`: Имеет доступ к кнопке «Админ-панель», может добавлять, блокировать и удалять любых пользователей. Видит все данные.
    *   `User`: Рядовой сотрудник (прораб/рабочий). Видит только свои объекты и может подавать отчеты.
*   **Объекты**: Пользователь видит в списке только те объекты, которые привязаны к нему в листе `UserAssignments`.

## 2. Процесс подачи отчета
1.  **Выбор объекта**: Пользователь выбирает из списка доступных строек.
2.  **Выбор работ**: Приложение запрашивает список позиций, у которых в таблице `Positions` прописан `object_id` выбранного объекта.
3.  **Ввод данных**: Пользователь указывает количество выполненных работ.
4.  **Экономический Snapshot**:
    *   Скрипт находит в таблице колонку, название которой совпадает с `Contractor` пользователя.
    *   Берет цену из этой колонки и `client_price`.
    *   Записывает отчет в журнал `Data_v2`, фиксируя цены. Это защищает историю от изменения цен в будущем.

## 3. Модуль «Выработка» (Бригадный метод)
*   Данные агрегируются «на лету» из журнала `Data_v2`.
*   Пользователь видит суммарную выработку **всех сотрудников своего подрядчика**. 
*   Если два прораба работают на одну фирму («ИП Иванов»), они будут видеть общий результат своей компании по каждой позиции.

## 4. Администрирование
*   Управление пользователями происходит прямо в мобильном интерфейсе.
*   Любые изменения (смена подрядчика, блокировка) вступают в силу мгновенно без перезагрузки Google Таблицы.
